name: Deploy PDF

on:
  push:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2
    
      - name: Install LaTeX
        run: |
          sudo apt-get update
          sudo apt-get install -y texlive-full
          sudo apt-get install -y texlive-luatex

      - name: Compile LaTeX to PDF
        run: make

      - name: Upload Artifact
        uses: actions/upload-artifact@v2
        with:
          name: my-cv
          path: cv.pdf

      - name: Trigger workflow in niclaurenti.github.io
        uses: peter-evans/repository-dispatch@v1
        with:
          token: ${{ secrets.REPO_ACCESS_TOKEN }}
          repository: niclaurenti/niclaurenti.github.io
          event-type: upload-event
